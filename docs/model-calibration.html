<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>4 Model Calibration | MOSAIC: a spatial model of endemic cholera</title>
<meta name="author" content="John R Giles">
<meta name="description" content="4.1 Bayesian Likelihood Approach The MOSAIC framework employs Bayesian inference to calibrate epidemiological models by systematically estimating parameters and their uncertainties from observed...">
<meta name="generator" content="bookdown 0.40 with bs4_book()">
<meta property="og:title" content="4 Model Calibration | MOSAIC: a spatial model of endemic cholera">
<meta property="og:type" content="book">
<meta property="og:description" content="4.1 Bayesian Likelihood Approach The MOSAIC framework employs Bayesian inference to calibrate epidemiological models by systematically estimating parameters and their uncertainties from observed...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="4 Model Calibration | MOSAIC: a spatial model of endemic cholera">
<meta name="twitter:description" content="4.1 Bayesian Likelihood Approach The MOSAIC framework employs Bayesian inference to calibrate epidemiological models by systematically estimating parameters and their uncertainties from observed...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">MOSAIC: a spatial model of endemic cholera</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled"><li><a class="" href="index.html"><span class="header-section-number">4</span> Model Calibration</a></li></ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/InstituteforDiseaseModeling/MOSAIC-docs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="model-calibration" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Model Calibration<a class="anchor" aria-label="anchor" href="#model-calibration"><i class="fas fa-link"></i></a>
</h1>
<div id="bayesian-likelihood-approach" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Bayesian Likelihood Approach<a class="anchor" aria-label="anchor" href="#bayesian-likelihood-approach"><i class="fas fa-link"></i></a>
</h2>
<p>The MOSAIC framework employs Bayesian inference to calibrate epidemiological models by systematically estimating parameters and their uncertainties from observed data. Bayesian inference updates prior beliefs about parameters using observed data through the likelihood function. The posterior probability distribution of the parameter vector <span class="math inline">\(\boldsymbol{\Theta}\)</span>, which includes transmission rates, mobility parameters, and seasonal forcing coefficients (e.g., <span class="math inline">\(\boldsymbol{\Theta} = \{\beta, \gamma, \omega, a_1, a_2, b_1, b_2\}\)</span>), given the observed data, is defined by Bayesâ€™ theorem:</p>
<p><span class="math display">\[\begin{equation}
P(\boldsymbol{\Theta} \mid \text{data}) = \frac{P(\text{data} \mid \boldsymbol{\Theta}) \cdot P(\boldsymbol{\Theta})}{P(\text{data})}
(#eq\:bayes)
\end{equation}\]</span></p>
<p>We calibrate by minimizing the negative log-likelihood, assuming a fixed or uninformative prior:</p>
<p><span class="math display">\[\begin{equation}
\hat{\boldsymbol{\Theta}} = \underset{\boldsymbol{\Theta}}{\arg\min}\big\[-\log L(\boldsymbol{\Theta})\big]
(#eq\:min-log-likelihood)
\end{equation}\]</span></p>
</div>
<div id="total-log-likelihood-for-cases-and-deaths" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Total Log-likelihood for Cases and Deaths<a class="anchor" aria-label="anchor" href="#total-log-likelihood-for-cases-and-deaths"><i class="fas fa-link"></i></a>
</h2>
<p>The total log-likelihood combines contributions from observed cases and deaths across locations and time points, weighted by their respective location-specific, time-specific, and outcome-specific weights. This combined likelihood function quantifies the probability of the observed epidemiological data given the model-estimated parameters and dispersion parameters:</p>
<p><span class="math display">\[\begin{equation}
\log L(\boldsymbol{\Theta}) =
\sum\_{j=1}^{J} w\_{j} \left\[
w\_{\text{cases}} \sum\_{t=1}^{T} w\_{t},\log P\left(C\_{j,t}^{\text{obs}} \mid C\_{j,t}^{\text{est}}(\boldsymbol{\Theta}), k\_{\text{cases},j}\right) * w\_{\text{deaths}} \sum\_{t=1}^{T} w\_{t},\log P\left(D\_{j,t}^{\text{obs}} \mid D\_{j,t}^{\text{est}}(\boldsymbol{\Theta}), k\_{\text{deaths},j}\right)
\right]
(#eq\:total_log_likelihood)
\end{equation}\]</span></p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="38%">
<col width="61%">
</colgroup>
<thead><tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(J\)</span></td>
<td>Number of locations</td>
</tr>
<tr class="even">
<td><span class="math inline">\(T\)</span></td>
<td>Number of time points</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(C_{j,t}^{\text{obs}}\)</span></td>
<td>Observed cases at location <span class="math inline">\(j\)</span> and time <span class="math inline">\(t\)</span>
</td>
</tr>
<tr class="even">
<td><span class="math inline">\(D_{j,t}^{\text{obs}}\)</span></td>
<td>Observed deaths at location <span class="math inline">\(j\)</span> and time <span class="math inline">\(t\)</span>
</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(C_{j,t}^{\text{est}}(\boldsymbol{\Theta})\)</span></td>
<td>Model-estimated mean cases at location <span class="math inline">\(j\)</span>, time <span class="math inline">\(t\)</span>
</td>
</tr>
<tr class="even">
<td><span class="math inline">\(D_{j,t}^{\text{est}}(\boldsymbol{\Theta})\)</span></td>
<td>Model-estimated mean deaths at location <span class="math inline">\(j\)</span>, time <span class="math inline">\(t\)</span>
</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(w_j\)</span></td>
<td>Location-specific weights (reflecting population or data confidence)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(w_t\)</span></td>
<td>Time-specific weights (typically uniform, <span class="math inline">\(w_t=1\)</span>)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(w_{\text{cases}}\)</span></td>
<td>Relative weight for cases</td>
</tr>
<tr class="even">
<td><span class="math inline">\(w_{\text{deaths}}\)</span></td>
<td>Relative weight for deaths</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(k_{\text{cases}, j}\)</span></td>
<td>Dispersion parameter for cases at location <span class="math inline">\(j\)</span>
</td>
</tr>
<tr class="even">
<td><span class="math inline">\(k_{\text{deaths}, j}\)</span></td>
<td>Dispersion parameter for deaths at location <span class="math inline">\(j\)</span>
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="distributional-assumptions-for-count-processes" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Distributional Assumptions for Count Processes<a class="anchor" aria-label="anchor" href="#distributional-assumptions-for-count-processes"><i class="fas fa-link"></i></a>
</h2>
<p>Data often exhibit overdispersion (variance &gt; mean), thus the Negative Binomial distribution is the default. When variance-to-mean ratio (VMR) &lt; 1.5, the Poisson distribution is used instead.</p>
<div id="negative-binomial-distribution" class="section level3" number="4.3.1">
<h3>
<span class="header-section-number">4.3.1</span> 3.1 Negative Binomial Distribution<a class="anchor" aria-label="anchor" href="#negative-binomial-distribution"><i class="fas fa-link"></i></a>
</h3>
<p>Used when VMR <span class="math inline">\(\geq 1.5\)</span>:</p>
<p><span class="math display">\[\begin{equation}
\log P\_{\text{NB}}(y \mid \mu, k) = \log \Gamma(y + k) - \log \Gamma(k) - \log \Gamma(y + 1) + k \log\left(\frac{k}{k + \mu}\right) + y \log\left(\frac{\mu}{k + \mu}\right) (#eq\:foi-human-neg-binomial)
\end{equation}\]</span></p>
<p>The dispersion parameter <span class="math inline">\(k\)</span> for location <span class="math inline">\(j\)</span> is calculated from observed data at location <span class="math inline">\(j\)</span> as:</p>
<p><span class="math display">\[\begin{equation}
k\_j = \frac{\mu\_j^2}{\text{Var}(y\_j) - \mu\_j} (#eq\:foi-human-dispersion)
\end{equation}\]</span></p>
<p>As <span class="math inline">\(k \rightarrow \infty\)</span>, the Negative Binomial distribution converges to the Poisson distribution.</p>
</div>
<div id="poisson-distribution" class="section level3" number="4.3.2">
<h3>
<span class="header-section-number">4.3.2</span> 3.2 Poisson Distribution<a class="anchor" aria-label="anchor" href="#poisson-distribution"><i class="fas fa-link"></i></a>
</h3>
<p>Used when VMR <span class="math inline">\(&lt; 1.5\)</span>, indicating near equivalence of mean and variance:</p>
<p><span class="math display">\[\begin{equation}
\log P\_{\text{Pois}}(y \mid \mu) = y \log \mu - \mu - \log(y!) (#eq\:foi-human-poisson)
\end{equation}\]</span></p>
</div>
</div>
<div id="algorithm-for-parameter-estimation" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Algorithm for Parameter Estimation<a class="anchor" aria-label="anchor" href="#algorithm-for-parameter-estimation"><i class="fas fa-link"></i></a>
</h2>
<p>We employ a simulation-based calibration algorithm:</p>
<ul>
<li>Draw <span class="math inline">\(n_{\text{simulation}}\)</span> random parameter vectors <span class="math inline">\(\boldsymbol{\Theta}\)</span> from predefined parameter space.</li>
<li>For each sampled <span class="math inline">\(\boldsymbol{\Theta}\)</span>, run <span class="math inline">\(n_{\text{iterations}}\)</span> model iterations.</li>
<li>Calculate the total negative log-likelihood for each parameter vector.</li>
<li>Select the parameter set that minimizes the negative log-likelihood as the best model estimate.</li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="empty"></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>MOSAIC: a spatial model of endemic cholera</strong>" was written by John R Giles. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
